(function(){function e(){if(!this instanceof e)return new e;else this._channels=new d}function d(){if(!this instanceof d)return new d;else this._callbacks=[],this._channels=[]}d.prototype={AddSubscriber:function(a,b,c){this._callbacks.push({fn:a,context:b,options:c})},AddChannel:function(a){this._channels[a]=new d},HasChannel:function(a){return this._channels.hasOwnProperty(a)},ReturnChannel:function(a){return this._channels[a]},RemoveSubscriber:function(a){if(!a)this._callbacks=[];for(var b in this._callbacks)this._callbacks.hasOwnProperty(b)&&
this._callbacks[b].fn==a&&this._callbacks.splice(b,1);for(var c in this._channels)this._channels.hasOwnProperty(c)&&this._channels[c].RemoveSubscriber(a)},Publish:function(a){for(var b in this._callbacks)if(this._callbacks.hasOwnProperty(b)){var c=this._callbacks[b];c.options!==void 0&&typeof c.options.predicate=="function"?c.options.predicate.apply(c.context,a)&&c.fn.apply(c.context,a):c.fn.apply(c.context,a)}for(b in this._channels)this._channels.hasOwnProperty(b)&&this._channels[b].Publish(a)}};
e.prototype={_channelFromNamespace:function(a){var b=this._channels,a=a.split(":");if(a.length>0)for(var c=0,d=a.length;c<d;c++)b.HasChannel(a[c])||b.AddChannel(a[c]),b=b.ReturnChannel(a[c]);return b},Subscribe:function(a,b,c,d){c=c||{};d===void 0&&(d=window);this._channelFromNamespace(a).AddSubscriber(b,d,c)},Remove:function(a,b){this._channelFromNamespace(a).RemoveSubscriber(b)},Publish:function(a){var b=Array.prototype.slice.call(arguments,1);this._channelFromNamespace(a).Publish(b)}};window.Mediator=
e;window.Mediator.Channel=d})(window);
