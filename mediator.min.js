(function(){function e(){if(!this instanceof e)return new e;else this._channels=new d}function d(){if(!this instanceof d)return new d;else this._callbacks=[],this._channels=[]}d.prototype={AddSubscriber:function(a,c,b){this._callbacks.push({fn:a,context:b,options:c})},AddChannel:function(a){this._channels[a]=new d},HasChannel:function(a){return this._channels.hasOwnProperty(a)},ReturnChannel:function(a){return this._channels[a]},RemoveSubscriber:function(a){if(!a)this._callbacks=[];for(var c in this._callbacks)this._callbacks.hasOwnProperty(c)&&
this._callbacks[c].fn==a&&this._callbacks.splice(c,1);for(var b in this._channels)this._channels.hasOwnProperty(b)&&this._channels[b].RemoveSubscriber(a)},Publish:function(a){for(var c in this._callbacks)if(this._callbacks.hasOwnProperty(c)){var b=this._callbacks[c];b.options!==void 0&&typeof b.options.predicate=="function"?b.options.predicate.apply(b.context,a)&&b.fn.apply(b.context,a):b.fn.apply(b.context,a)}for(c in this._channels)this._channels.hasOwnProperty(c)&&this._channels[c].Publish(a)}};
e.prototype={_channelFromNamespace:function(a){var c=this._channels,a=a.split(":");if(a.length>0)for(var b=0,d=a.length;b<d;b++)c.HasChannel(a[b])||c.AddChannel(a[b]),c=c.ReturnChannel(a[b]);return c},Subscribe:function(a,c,b,d){b=b||{};this._channelFromNamespace(a).AddSubscriber(c,b,d||window)},Remove:function(a,c){this._channelFromNamespace(a).RemoveSubscriber(c)},Publish:function(a){this._channelFromNamespace(a).Publish(Array.prototype.slice.call(arguments,1))}};window.Mediator=e;window.Mediator.Channel=
d})(window);
